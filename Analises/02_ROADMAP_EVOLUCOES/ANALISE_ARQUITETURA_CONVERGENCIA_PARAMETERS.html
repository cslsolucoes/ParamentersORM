<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise de Arquitetura - Converg√™ncia Parameters</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 4px solid #3498db;
        }
        h3 {
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .summary {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        .phase {
            background: #fff;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .phase.critical {
            border-left-color: #e74c3c;
        }
        .phase.medium {
            border-left-color: #f39c12;
        }
        .code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 10px 0;
        }
        .code pre {
            margin: 0;
            padding: 0;
            font-family: 'Courier New', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #34495e;
            color: white;
            font-weight: bold;
        }
        tr:hover {
            background: #f5f5f5;
        }
        .common {
            background: #d4edda;
        }
        .exclusive-db {
            background: #fff3cd;
        }
        .exclusive-ini {
            background: #d1ecf1;
        }
        .exclusive-json {
            background: #f8d7da;
        }
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .warning {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .architecture {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .architecture-diagram {
            font-family: 'Courier New', monospace;
            background: white;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .architecture-diagram pre {
            margin: 0;
            padding: 0;
            font-family: 'Courier New', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .status-completed {
            color: #27ae60;
            font-weight: bold;
        }
        .status-pending {
            color: #e74c3c;
            font-weight: bold;
        }
        .status-in-progress {
            color: #f39c12;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç AN√ÅLISE DE ARQUITETURA - CONVERG√äNCIA PARAMETERS</h1>
        
        <div class="summary">
            <h2>üìä Resumo Executivo</h2>
            <p><strong>Objetivo:</strong> Criar interface <code>IParameters</code> unificada com suporte a m√∫ltiplas fontes de dados e fallback autom√°tico para conting√™ncia.</p>
            <p><strong>Data:</strong> 02/01/2026</p>
            <p><strong>Status:</strong> <span class="status-pending">‚ùå AN√ÅLISE - Aguardando Implementa√ß√£o</span></p>
        </div>

        <div class="info">
            <h3>üìã Contexto</h3>
            <p>Atualmente, o m√≥dulo Parameters possui tr√™s interfaces separadas:</p>
            <ul>
                <li><code>IParametersDatabase</code> - Acesso via banco de dados</li>
                <li><code>IParametersInifiles</code> - Acesso via arquivos INI</li>
                <li><code>IParametersJsonObject</code> - Acesso via objetos JSON</li>
            </ul>
            <p><strong>Problema:</strong> N√£o h√° uma interface unificada que permita fallback autom√°tico quando uma fonte falha (ex: banco de dados indispon√≠vel).</p>
            <p><strong>Solu√ß√£o:</strong> Criar <code>IParameters</code> como interface principal que gerencia m√∫ltiplas fontes com ordem de prioridade configur√°vel.</p>
        </div>

        <div class="warning">
            <h3>üîí Encapsulamento e Visibilidade</h3>
            <p><strong>Arquitetura de Encapsulamento:</strong> Apenas 2 arquivos ficam expostos externamente:</p>
            <ul>
                <li><strong>‚úÖ Modulo.Parameters.pas</strong> - Ponto de entrada p√∫blico (Factory methods)</li>
                <li><strong>‚úÖ Modulo.Parameters.Intefaces.pas</strong> - Interfaces p√∫blicas (IParameters, IParametersDatabase, IParametersInifiles, IParametersJsonObject)</li>
            </ul>
            <p><strong>Arquivos Internos (implementation only):</strong></p>
            <ul>
                <li>‚ùå <code>Modulo.Parameters.Database.pas</code> - Apenas na se√ß√£o implementation</li>
                <li>‚ùå <code>Modulo.Parameters.Inifiles.pas</code> - Apenas na se√ß√£o implementation</li>
                <li>‚ùå <code>Modulo.Parameters.JsonObject.pas</code> - Apenas na se√ß√£o implementation</li>
                <li>‚ùå <code>Modulo.Parameters.Types.pas</code> - Apenas na se√ß√£o implementation (re-exportado via Interfaces)</li>
                <li>‚ùå <code>Modulo.Parameters.Consts.pas</code> - Apenas na se√ß√£o implementation</li>
                <li>‚ùå <code>Modulo.Parameters.Exceptions.pas</code> - Apenas na se√ß√£o implementation</li>
            </ul>
            <p><strong>Benef√≠cios:</strong></p>
            <ul>
                <li>‚úÖ Encapsulamento completo - Implementa√ß√µes n√£o s√£o acess√≠veis externamente</li>
                <li>‚úÖ Facilita manuten√ß√£o - Mudan√ßas internas n√£o afetam c√≥digo externo</li>
                <li>‚úÖ Reduz depend√™ncias - C√≥digo externo n√£o precisa conhecer implementa√ß√µes</li>
                <li>‚úÖ Melhor organiza√ß√£o - Separa√ß√£o clara entre API p√∫blica e implementa√ß√£o</li>
            </ul>
        </div>

        <h2>üî¨ An√°lise de M√©todos Comuns vs Exclusivos</h2>

        <div class="phase">
            <h3>üìã M√©todos Comuns (Presentes em todas as 3 interfaces)</h3>
            <p>Estes m√©todos ser√£o implementados diretamente em <code>IParameters</code> com fallback autom√°tico:</p>
            
            <table>
                <thead>
                    <tr>
                        <th>M√©todo</th>
                        <th>Database</th>
                        <th>Inifiles</th>
                        <th>JsonObject</th>
                        <th>A√ß√£o em IParameters</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="common">
                        <td><code>List()</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Busca em todas as fontes ativas (merge)</td>
                    </tr>
                    <tr class="common">
                        <td><code>Get(AName)</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Busca em cascata (Database ‚Üí Inifiles ‚Üí JsonObject)</td>
                    </tr>
                    <tr class="common">
                        <td><code>Insert(AParameter)</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Insere na fonte ativa (default: Database)</td>
                    </tr>
                    <tr class="common">
                        <td><code>Update(AParameter)</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Atualiza na fonte onde o par√¢metro existe</td>
                    </tr>
                    <tr class="common">
                        <td><code>Delete(AName)</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Deleta de todas as fontes onde existe</td>
                    </tr>
                    <tr class="common">
                        <td><code>Exists(AName)</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Verifica em todas as fontes (OR l√≥gico)</td>
                    </tr>
                    <tr class="common">
                        <td><code>Count()</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Soma de todas as fontes ativas</td>
                    </tr>
                    <tr class="common">
                        <td><code>Refresh()</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Refresh em todas as fontes ativas</td>
                    </tr>
                    <tr class="common">
                        <td><code>ContratoID(AValue)</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Configura em todas as fontes ativas</td>
                    </tr>
                    <tr class="common">
                        <td><code>ProdutoID(AValue)</code></td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>‚úÖ</td>
                        <td>Configura em todas as fontes ativas</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="phase">
            <h3>üîß M√©todos Exclusivos - Database</h3>
            <p>Estes m√©todos ser√£o acess√≠veis apenas via <code>IParameters.Database</code>:</p>
            
            <table>
                <thead>
                    <tr>
                        <th>M√©todo</th>
                        <th>Descri√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="exclusive-db">
                        <td><code>Connect()</code></td>
                        <td>Conecta ao banco de dados</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Disconnect()</code></td>
                        <td>Desconecta do banco de dados</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>IsConnected()</code></td>
                        <td>Verifica se est√° conectado</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>TableExists()</code></td>
                        <td>Verifica se a tabela existe</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>CreateTable()</code></td>
                        <td>Cria a tabela se n√£o existir</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Engine()</code></td>
                        <td>Configura engine (UNIDAC, FireDAC, Zeos)</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>DatabaseType()</code></td>
                        <td>Configura tipo de banco (PostgreSQL, MySQL, etc.)</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Host()</code></td>
                        <td>Configura host do banco</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Port()</code></td>
                        <td>Configura porta do banco</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Username()</code></td>
                        <td>Configura usu√°rio</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Password()</code></td>
                        <td>Configura senha</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Database()</code></td>
                        <td>Configura nome do banco</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Schema()</code></td>
                        <td>Configura schema</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>TableName()</code></td>
                        <td>Configura nome da tabela</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>AutoCreateTable()</code></td>
                        <td>Auto-criar tabela se n√£o existir</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Connection()</code></td>
                        <td>Define conex√£o externa</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>Query()</code></td>
                        <td>Define query externa</td>
                    </tr>
                    <tr class="exclusive-db">
                        <td><code>ExecQuery()</code></td>
                        <td>Define exec query externa</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="phase">
            <h3>üìÑ M√©todos Exclusivos - Inifiles</h3>
            <p>Estes m√©todos ser√£o acess√≠veis apenas via <code>IParameters.Inifiles</code>:</p>
            
            <table>
                <thead>
                    <tr>
                        <th>M√©todo</th>
                        <th>Descri√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="exclusive-ini">
                        <td><code>FilePath()</code></td>
                        <td>Configura caminho do arquivo INI</td>
                    </tr>
                    <tr class="exclusive-ini">
                        <td><code>Section()</code></td>
                        <td>Configura se√ß√£o do INI</td>
                    </tr>
                    <tr class="exclusive-ini">
                        <td><code>AutoCreateFile()</code></td>
                        <td>Auto-criar arquivo se n√£o existir</td>
                    </tr>
                    <tr class="exclusive-ini">
                        <td><code>FileExists()</code></td>
                        <td>Verifica se o arquivo existe</td>
                    </tr>
                    <tr class="exclusive-ini">
                        <td><code>ImportFromDatabase()</code></td>
                        <td>Importa do Database para INI</td>
                    </tr>
                    <tr class="exclusive-ini">
                        <td><code>ExportToDatabase()</code></td>
                        <td>Exporta do INI para Database</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="phase">
            <h3>üì¶ M√©todos Exclusivos - JsonObject</h3>
            <p>Estes m√©todos ser√£o acess√≠veis apenas via <code>IParameters.JsonObject</code>:</p>
            
            <table>
                <thead>
                    <tr>
                        <th>M√©todo</th>
                        <th>Descri√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="exclusive-json">
                        <td><code>JsonObject()</code></td>
                        <td>Configura objeto JSON</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>ObjectName()</code></td>
                        <td>Configura nome do objeto JSON</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>FilePath()</code></td>
                        <td>Configura caminho do arquivo JSON</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>AutoCreateFile()</code></td>
                        <td>Auto-criar arquivo se n√£o existir</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>FileExists()</code></td>
                        <td>Verifica se o arquivo existe</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>ToJSON()</code></td>
                        <td>Retorna objeto JSON</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>ToJSONString()</code></td>
                        <td>Retorna string JSON formatada</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>SaveToFile()</code></td>
                        <td>Salva JSON em arquivo</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>LoadFromFile()</code></td>
                        <td>Carrega JSON de arquivo</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>LoadFromString()</code></td>
                        <td>Carrega JSON de string</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>ImportFromDatabase()</code></td>
                        <td>Importa do Database para JSON</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>ExportToDatabase()</code></td>
                        <td>Exporta do JSON para Database</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>ImportFromInifiles()</code></td>
                        <td>Importa do INI para JSON</td>
                    </tr>
                    <tr class="exclusive-json">
                        <td><code>ExportToInifiles()</code></td>
                        <td>Exporta do JSON para INI</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2>üèóÔ∏è Nova Arquitetura Proposta</h2>

        <div class="architecture">
            <h3>Estrutura de Interfaces</h3>
            <div class="architecture-diagram">
                <pre>IParameters (Interface Principal - Converg√™ncia)
    ‚îú‚îÄ‚îÄ‚Üí IParametersDatabase (Acesso direto)
    ‚îú‚îÄ‚îÄ‚Üí IParametersInifiles (Acesso direto)
    ‚îî‚îÄ‚îÄ‚Üí IParametersJsonObject (Acesso direto)
    
    M√©todos Comuns (com fallback):
    - Get() ‚Üí Busca em cascata
    - List() ‚Üí Merge de todas as fontes
    - Insert() ‚Üí Fonte ativa (default: Database)
    - Update() ‚Üí Fonte onde existe
    - Delete() ‚Üí Todas as fontes
    - Exists() ‚Üí OR l√≥gico
    - Count() ‚Üí Soma de todas
    - Refresh() ‚Üí Todas as fontes</pre>
            </div>
        </div>

        <div class="architecture">
            <h3>Estrutura de Arquivos e Visibilidade</h3>
            <div class="architecture-diagram">
                <pre>üìÅ src/Modulos/Parameters/
‚îÇ
‚îú‚îÄ‚îÄ ‚úÖ Modulo.Parameters.pas (P√öBLICO - Ponto de Entrada)
‚îÇ   ‚îî‚îÄ‚îÄ‚Üí Factory methods: New(), NewDatabase(), NewInifiles(), NewJsonObject()
‚îÇ   ‚îî‚îÄ‚îÄ‚Üí uses (implementation): Database, Inifiles, JsonObject, Types, Consts, Exceptions
‚îÇ
‚îú‚îÄ‚îÄ ‚úÖ Modulo.Parameters.Intefaces.pas (P√öBLICO - Interfaces)
‚îÇ   ‚îî‚îÄ‚îÄ‚Üí IParameters (nova interface principal)
‚îÇ   ‚îî‚îÄ‚îÄ‚Üí IParametersDatabase
‚îÇ   ‚îî‚îÄ‚îÄ‚Üí IParametersInifiles
‚îÇ   ‚îî‚îÄ‚îÄ‚Üí IParametersJsonObject
‚îÇ   ‚îî‚îÄ‚îÄ‚Üí Re-exporta: TParameter, TParameterList, TParameterSource, etc.
‚îÇ
‚îî‚îÄ‚îÄ üîí IMPLEMENTA√á√ÉO (apenas na se√ß√£o implementation)
    ‚îú‚îÄ‚îÄ Modulo.Parameters.Database.pas (TParametersDatabase)
    ‚îú‚îÄ‚îÄ Modulo.Parameters.Inifiles.pas (TParametersInifiles)
    ‚îú‚îÄ‚îÄ Modulo.Parameters.JsonObject.pas (TParametersJsonObject)
    ‚îú‚îÄ‚îÄ Modulo.Parameters.Types.pas (TParameter, TParameterList, etc.)
    ‚îú‚îÄ‚îÄ Modulo.Parameters.Consts.pas (Constantes)
    ‚îî‚îÄ‚îÄ Modulo.Parameters.Exceptions.pas (Exce√ß√µes customizadas)

üì¶ C√≥digo Externo:
   uses Modulo.Parameters; // Apenas este!
   // Acesso via interfaces p√∫blicas apenas</pre>
            </div>
        </div>

        <div class="phase critical">
            <h3>üìù Interface IParameters Proposta</h3>
            <div class="code">
                <pre>IParameters = interface
  ['{D1E2F3A4-B5C6-7890-DEF1-234567890ABC}']
  
  // ========== GERENCIAMENTO DE FONTES ==========
  function Source(ASource: TParameterSource): IParameters; overload;
  function Source: TParameterSource; overload;
  function AddSource(ASource: TParameterSource): IParameters;
  function RemoveSource(ASource: TParameterSource): IParameters;
  function HasSource(ASource: TParameterSource): Boolean;
  function Priority(ASources: TArray&lt;TParameterSource&gt;): IParameters;
  function Sources: TArray&lt;TParameterSource&gt;;
  
  // ========== OPERA√á√ïES UNIFICADAS (com fallback) ==========
  function Get(const AName: string): TParameter; overload;
  function Get(const AName: string; ASource: TParameterSource): TParameter; overload;
  function List: TParameterList; overload;
  function List(out AList: TParameterList): IParameters; overload;
  function Insert(const AParameter: TParameter): IParameters; overload;
  function Insert(const AParameter: TParameter; out ASuccess: Boolean): IParameters; overload;
  function Update(const AParameter: TParameter): IParameters; overload;
  function Update(const AParameter: TParameter; out ASuccess: Boolean): IParameters; overload;
  function Delete(const AName: string): IParameters; overload;
  function Delete(const AName: string; out ASuccess: Boolean): IParameters; overload;
  function Exists(const AName: string): Boolean; overload;
  function Exists(const AName: string; out AExists: Boolean): IParameters; overload;
  function Count: Integer; overload;
  function Count(out ACount: Integer): IParameters; overload;
  function Refresh: IParameters;
  
  // ========== CONFIGURA√á√ÉO UNIFICADA ==========
  function ContratoID(const AValue: Integer): IParameters; overload;
  function ContratoID: Integer; overload;
  function ProdutoID(const AValue: Integer): IParameters; overload;
  function ProdutoID: Integer; overload;
  
  // ========== ACESSO DIRETO A FONTES ==========
  function Database: IParametersDatabase;
  function Inifiles: IParametersInifiles;
  function JsonObject: IParametersJsonObject;
  
  // ========== NAVEGA√á√ÉO ==========
  function EndParameters: IInterface;
end;</pre>
            </div>
        </div>

        <div class="phase">
            <h3>üîÑ Estrat√©gia de Fallback</h3>
            <div class="note">
                <h4>Ordem de Prioridade Padr√£o:</h4>
                <ol>
                    <li><strong>Database</strong> - Fonte principal (mais confi√°vel, persistente)</li>
                    <li><strong>Inifiles</strong> - Fonte secund√°ria (conting√™ncia local)</li>
                    <li><strong>JsonObject</strong> - Fonte terci√°ria (conting√™ncia alternativa)</li>
                </ol>
            </div>
            
            <div class="info">
                <h4>Comportamento de Fallback:</h4>
                <ul>
                    <li><strong>Get()</strong>: Busca em cascata at√© encontrar o par√¢metro</li>
                    <li><strong>List()</strong>: Merge de todas as fontes ativas (remove duplicatas por Name)</li>
                    <li><strong>Insert()</strong>: Insere na fonte ativa (default: Database, fallback para primeira dispon√≠vel)</li>
                    <li><strong>Update()</strong>: Atualiza na fonte onde o par√¢metro existe</li>
                    <li><strong>Delete()</strong>: Deleta de todas as fontes onde existe</li>
                    <li><strong>Exists()</strong>: Retorna True se existir em qualquer fonte</li>
                    <li><strong>Count()</strong>: Soma de todas as fontes (remove duplicatas)</li>
                </ul>
            </div>
        </div>

        <div class="phase">
            <h3>üîß Atualiza√ß√£o de TParameterConfig</h3>
            <p>O tipo <code>TParameterConfig</code> ser√° expandido para suportar m√∫ltiplas op√ß√µes usando um set:</p>
            
            <div class="code">
                <pre>type
  TParameterConfig = set of (pcfNone, pcfDataBase, pcfInifile, pcfJsonObject);
  
  // Exemplos de uso:
  var
    Config: TParameterConfig;
  begin
    // Apenas Database
    Config := [pcfDataBase];
    
    // Database com fallback para INI
    Config := [pcfDataBase, pcfInifile];
    
    // Todas as fontes
    Config := [pcfDataBase, pcfInifile, pcfJsonObject];
    
    // Apenas arquivos (sem Database)
    Config := [pcfInifile, pcfJsonObject];
  end;</pre>
            </div>
        </div>

        <h2>üìã Estrutura de Implementa√ß√£o</h2>

        <div class="phase">
            <h3>Classe TParameters (Implementa√ß√£o - Modulo.Parameters.pas)</h3>
            <div class="code">
                <pre>// =============================================================================
// Modulo.Parameters.pas - PONTO DE ENTRADA P√öBLICO
// =============================================================================
// Este √© o √öNICO arquivo que deve ser usado externamente!
// Todas as implementa√ß√µes est√£o na se√ß√£o implementation e n√£o s√£o acess√≠veis.

interface
  uses Modulo.Parameters.Intefaces; // Apenas interfaces p√∫blicas
  
  type
    TParameters = class
    public
      // Factory principal - retorna IParameters
      class function New: IParameters; overload;
      class function New(AConfig: TParameterConfig): IParameters; overload;
      
      // Factory espec√≠ficos (compatibilidade)
      class function NewDatabase: IParametersDatabase; overload;
      class function NewInifiles: IParametersInifiles; overload;
      class function NewJsonObject: IParametersJsonObject; overload;
    end;

implementation
  // ========== IMPLEMENTA√á√ïES INTERNAS (n√£o acess√≠veis externamente) ==========
  uses
    Modulo.Parameters.Database,    // TParametersDatabase
    Modulo.Parameters.Inifiles,    // TParametersInifiles
    Modulo.Parameters.JsonObject,  // TParametersJsonObject
    Modulo.Parameters.Types,       // TParameter, TParameterList, etc.
    Modulo.Parameters.Consts,      // Constantes
    Modulo.Parameters.Exceptions;  // Exce√ß√µes
  
  type
    TParametersImpl = class(TInterfacedObject, IParameters)
    private
      FDatabase: IParametersDatabase;
      FInifiles: IParametersInifiles;
      FJsonObject: IParametersJsonObject;
      FActiveSource: TParameterSource;
      FPriority: TArray&lt;TParameterSource&gt;;
      FConfig: TParameterConfig;
      FLock: TCriticalSection;
      
      function GetSource(ASource: TParameterSource): IInterface;
      function TryGetFromSource(const AName: string; ASource: TParameterSource; out AParameter: TParameter): Boolean;
    public
      constructor Create(AConfig: TParameterConfig);
      destructor Destroy; override;
      
      // IParameters implementation
      // ... (todos os m√©todos da interface)
    end;
  
  // Factory methods
  class function TParameters.New: IParameters;
  begin
    Result := TParametersImpl.Create([pcfDataBase]); // Default
  end;
  
  class function TParameters.New(AConfig: TParameterConfig): IParameters;
  begin
    Result := TParametersImpl.Create(AConfig);
  end;
  
  // ... (outros factory methods)</pre>
            </div>
        </div>

        <div class="phase">
            <h3>Factory Methods Atualizados (Modulo.Parameters.pas)</h3>
            <div class="code">
                <pre>// =============================================================================
// Modulo.Parameters.pas - INTERFACE P√öBLICA
// =============================================================================
// Apenas esta interface √© exposta externamente!

type
  TParameters = class
  public
    // ========== FACTORY PRINCIPAL - Retorna IParameters ==========
    class function New: IParameters; overload;
    class function New(AConfig: TParameterConfig): IParameters; overload;
    
    // ========== FACTORY ESPEC√çFICOS (Compatibilidade) ==========
    // Estes m√©todos retornam interfaces espec√≠ficas para uso direto
    // (sem converg√™ncia/fallback)
    
    class function NewDatabase: IParametersDatabase; overload;
    class function NewDatabase(AConnection: TObject; AQuery: TDataSet = nil; AExecQuery: TDataSet = nil): IParametersDatabase; overload;
    
    class function NewInifiles: IParametersInifiles; overload;
    class function NewInifiles(const AFilePath: string): IParametersInifiles; overload;
    
    class function NewJsonObject: IParametersJsonObject; overload;
    class function NewJsonObject(AJsonObject: TJSONObject): IParametersJsonObject; overload;
    class function NewJsonObjectFromFile(const AFilePath: string): IParametersJsonObject;
  end;</pre>
            </div>
            <div class="note">
                <h4>üìù Nota sobre Encapsulamento:</h4>
                <p>Todas as implementa√ß√µes (<code>TParametersImpl</code>, <code>TParametersDatabase</code>, <code>TParametersInifiles</code>, <code>TParametersJsonObject</code>) ficam na se√ß√£o <code>implementation</code> e n√£o s√£o acess√≠veis externamente.</p>
                <p>O c√≥digo externo s√≥ conhece as interfaces p√∫blicas definidas em <code>Modulo.Parameters.Intefaces.pas</code>.</p>
            </div>
        </div>

        <h2>üí° Exemplos de Uso</h2>

        <div class="phase">
            <h3>Exemplo 1: Uso B√°sico com Fallback Autom√°tico</h3>
            <div class="code">
                <pre>// =============================================================================
// C√≥digo Externo - Apenas usa Modulo.Parameters
// =============================================================================
uses
  Modulo.Parameters; // Apenas este! N√£o precisa conhecer Database, Inifiles, etc.

var
  Parameters: IParameters;
  Param: TParameter;
begin
  // Cria com Database como padr√£o, INI como fallback
  Parameters := TParameters.New([pcfDataBase, pcfInifile]);
  
  // Configura Database (acesso direto via interface)
  Parameters.Database
    .Host('localhost')
    .Database('mydb')
    .TableName('config')
    .Connect;
  
  // Configura INI como fallback (acesso direto via interface)
  Parameters.Inifiles
    .FilePath('D:\Dados\config.ini')
    .Section('Database');
  
  // Busca par√¢metro (tenta Database primeiro, depois INI)
  // Fallback autom√°tico se Database falhar
  Param := Parameters.Get('database_host');
  ShowMessage(Param.Value);
end;</pre>
            </div>
            <div class="info">
                <h4>üí° Encapsulamento:</h4>
                <p>O c√≥digo externo n√£o precisa conhecer <code>TParametersDatabase</code>, <code>TParametersInifiles</code> ou <code>TParametersJsonObject</code>.</p>
                <p>Apenas as interfaces p√∫blicas s√£o acess√≠veis: <code>IParameters</code>, <code>IParametersDatabase</code>, <code>IParametersInifiles</code>, <code>IParametersJsonObject</code>.</p>
            </div>
        </div>

        <div class="phase">
            <h3>Exemplo 2: Ordem de Prioridade Customizada</h3>
            <div class="code">
                <pre>var
  Parameters: IParameters;
begin
  Parameters := TParameters.New([pcfDataBase, pcfInifile, pcfJsonObject]);
  
  // Define ordem customizada: INI primeiro, depois Database, depois JSON
  Parameters.Priority([psInifiles, psDatabase, psJsonObject]);
  
  // Get() agora busca primeiro no INI
  Param := Parameters.Get('database_host');
end;</pre>
            </div>
        </div>

        <div class="phase">
            <h3>Exemplo 3: Conting√™ncia Autom√°tica</h3>
            <div class="code">
                <pre>var
  Parameters: IParameters;
begin
  Parameters := TParameters.New([pcfDataBase, pcfInifile]);
  
  // Tenta conectar ao Database
  if not Parameters.Database.Connect then
  begin
    // Se falhar, usa apenas INI
    Parameters.RemoveSource(psDatabase);
    ShowMessage('Database indispon√≠vel, usando INI como fallback');
  end;
  
  // Get() automaticamente usa INI se Database n√£o estiver dispon√≠vel
  Param := Parameters.Get('database_host');
end;</pre>
            </div>
        </div>

        <div class="phase">
            <h3>Exemplo 4: Acesso Direto a Fontes Espec√≠ficas</h3>
            <div class="code">
                <pre>var
  Parameters: IParameters;
begin
  Parameters := TParameters.New([pcfDataBase, pcfInifile, pcfJsonObject]);
  
  // Acesso direto ao Database (m√©todos exclusivos)
  Parameters.Database
    .Engine(pteUnidac)
    .DatabaseType(pdtPostgreSQL)
    .Host('localhost')
    .Port(5432)
    .Connect;
  
  // Acesso direto ao INI (m√©todos exclusivos)
  Parameters.Inifiles
    .FilePath('D:\Dados\config.ini')
    .Section('Database');
  
  // Acesso direto ao JSON (m√©todos exclusivos)
  Parameters.JsonObject
    .FilePath('D:\Dados\config.json')
    .ObjectName('Database');
  
  // Opera√ß√µes unificadas (com fallback)
  Param := Parameters.Get('database_host'); // Busca em cascata
  Parameters.Insert(Param); // Insere na fonte ativa
end;</pre>
            </div>
        </div>

        <h2>‚ö†Ô∏è Considera√ß√µes Importantes</h2>

        <div class="warning">
            <h3>‚ö†Ô∏è Thread-Safety</h3>
            <p>Todas as opera√ß√µes devem ser thread-safe usando <code>TCriticalSection</code> (FLock).</p>
            <p>O fallback deve ser at√¥mico para evitar condi√ß√µes de corrida.</p>
        </div>

        <div class="note">
            <h3>üí° Performance</h3>
            <p>O fallback pode impactar performance se muitas fontes estiverem configuradas.</p>
            <p>Recomenda√ß√£o: Limitar a 2-3 fontes por inst√¢ncia.</p>
            <p>Cache opcional pode ser implementado para melhorar performance.</p>
        </div>

        <div class="info">
            <h3>üìù Compatibilidade</h3>
            <p>Os m√©todos factory existentes (<code>NewDatabase</code>, <code>NewInifiles</code>, <code>NewJsonObject</code>) ser√£o mantidos para compatibilidade.</p>
            <p>O novo m√©todo <code>New</code> retorna <code>IParameters</code> (n√£o <code>IParametersDatabase</code>).</p>
        </div>

        <h2>üìä Plano de Implementa√ß√£o</h2>

        <div class="phase critical">
            <h3>Fase 1: Atualiza√ß√£o de Tipos (Modulo.Parameters.Types.pas)</h3>
            <ol>
                <li>Atualizar <code>TParameterConfig</code> para <code>set of</code></li>
                <li>Adicionar constantes de configura√ß√£o padr√£o</li>
                <li><strong>‚ö†Ô∏è IMPORTANTE:</strong> Este arquivo fica apenas na se√ß√£o <code>implementation</code> de <code>Modulo.Parameters.pas</code></li>
                <li>Tipos p√∫blicos s√£o re-exportados via <code>Modulo.Parameters.Intefaces.pas</code></li>
            </ol>
        </div>

        <div class="phase critical">
            <h3>Fase 2: Interface IParameters (Modulo.Parameters.Intefaces.pas)</h3>
            <ol>
                <li>Criar interface <code>IParameters</code> em <code>Modulo.Parameters.Intefaces.pas</code> (arquivo p√∫blico)</li>
                <li>Definir todos os m√©todos unificados</li>
                <li>Definir m√©todos de gerenciamento de fontes</li>
                <li>Re-exportar tipos p√∫blicos de <code>Modulo.Parameters.Types.pas</code> (TParameter, TParameterList, TParameterSource, etc.)</li>
                <li><strong>‚úÖ Este √© um dos 2 arquivos p√∫blicos!</strong></li>
            </ol>
        </div>

        <div class="phase critical">
            <h3>Fase 3: Implementa√ß√£o TParameters (Modulo.Parameters.pas - se√ß√£o implementation)</h3>
            <ol>
                <li>Criar classe <code>TParametersImpl</code> na se√ß√£o <code>implementation</code> de <code>Modulo.Parameters.pas</code></li>
                <li>Implementar <code>IParameters</code> em <code>TParametersImpl</code></li>
                <li>Implementar gerenciamento de fontes</li>
                <li>Implementar m√©todos unificados com fallback</li>
                <li>Implementar thread-safety</li>
                <li><strong>‚ö†Ô∏è IMPORTANTE:</strong> <code>TParametersImpl</code> n√£o √© acess√≠vel externamente!</li>
                <li>Factory methods p√∫blicos (<code>TParameters.New</code>) retornam <code>IParameters</code></li>
            </ol>
        </div>

        <div class="phase medium">
            <h3>Fase 4: Factory Methods (Modulo.Parameters.pas - interface p√∫blica)</h3>
            <ol>
                <li>Atualizar <code>TParameters.New</code> para retornar <code>IParameters</code></li>
                <li>Manter m√©todos espec√≠ficos (<code>NewDatabase</code>, <code>NewInifiles</code>, <code>NewJsonObject</code>) para compatibilidade</li>
                <li>Adicionar overloads com <code>TParameterConfig</code></li>
                <li><strong>‚úÖ Este √© um dos 2 arquivos p√∫blicos!</strong></li>
                <li>Garantir que todas as implementa√ß√µes ficam na se√ß√£o <code>implementation</code></li>
            </ol>
        </div>

        <div class="phase medium">
            <h3>Fase 5: Encapsulamento e Valida√ß√£o</h3>
            <ol>
                <li>Verificar que <code>Modulo.Parameters.Database.pas</code> est√° apenas na se√ß√£o <code>implementation</code></li>
                <li>Verificar que <code>Modulo.Parameters.Inifiles.pas</code> est√° apenas na se√ß√£o <code>implementation</code></li>
                <li>Verificar que <code>Modulo.Parameters.JsonObject.pas</code> est√° apenas na se√ß√£o <code>implementation</code></li>
                <li>Verificar que <code>Modulo.Parameters.Types.pas</code> est√° apenas na se√ß√£o <code>implementation</code> (tipos re-exportados via Interfaces)</li>
                <li>Verificar que <code>Modulo.Parameters.Consts.pas</code> est√° apenas na se√ß√£o <code>implementation</code></li>
                <li>Verificar que <code>Modulo.Parameters.Exceptions.pas</code> est√° apenas na se√ß√£o <code>implementation</code></li>
                <li>Testar que c√≥digo externo n√£o consegue acessar implementa√ß√µes diretamente</li>
            </ol>
        </div>

        <div class="phase medium">
            <h3>Fase 6: Testes</h3>
            <ol>
                <li>Testes de fallback autom√°tico</li>
                <li>Testes de m√∫ltiplas fontes</li>
                <li>Testes de thread-safety</li>
                <li>Testes de performance</li>
                <li>Testes de encapsulamento (verificar que implementa√ß√µes n√£o s√£o acess√≠veis)</li>
                <li>Testes de compatibilidade (c√≥digo existente continua funcionando)</li>
            </ol>
        </div>

        <div style="margin-top: 40px; padding: 20px; background: #ecf0f1; border-radius: 5px;">
            <p><strong>Data de Cria√ß√£o:</strong> 02/01/2026</p>
            <p><strong>√öltima Atualiza√ß√£o:</strong> 02/01/2026</p>
            <p><strong>Vers√£o:</strong> 1.1.0</p>
            <p><strong>Status:</strong> <span class="status-pending">‚ùå AN√ÅLISE - Aguardando Aprova√ß√£o e Implementa√ß√£o</span></p>
            
            <div class="warning" style="margin-top: 15px;">
                <h4>üîí Arquitetura de Encapsulamento</h4>
                <p><strong>Arquivos P√∫blicos (2):</strong></p>
                <ul>
                    <li>‚úÖ <code>Modulo.Parameters.pas</code> - Ponto de entrada (Factory methods)</li>
                    <li>‚úÖ <code>Modulo.Parameters.Intefaces.pas</code> - Interfaces p√∫blicas</li>
                </ul>
                <p><strong>Arquivos Internos (6 - apenas implementation):</strong></p>
                <ul>
                    <li>üîí <code>Modulo.Parameters.Database.pas</code></li>
                    <li>üîí <code>Modulo.Parameters.Inifiles.pas</code></li>
                    <li>üîí <code>Modulo.Parameters.JsonObject.pas</code></li>
                    <li>üîí <code>Modulo.Parameters.Types.pas</code> (tipos re-exportados via Interfaces)</li>
                    <li>üîí <code>Modulo.Parameters.Consts.pas</code></li>
                    <li>üîí <code>Modulo.Parameters.Exceptions.pas</code></li>
                </ul>
            </div>
            
            <p><strong>Pr√≥ximos Passos:</strong></p>
            <ol style="margin-left: 20px; margin-top: 10px;">
                <li>Revisar e aprovar an√°lise</li>
                <li>Atualizar <code>Modulo.Parameters.Types.pas</code> (TParameterConfig para set of)</li>
                <li>Criar interface <code>IParameters</code> em <code>Modulo.Parameters.Intefaces.pas</code></li>
                <li>Implementar classe <code>TParametersImpl</code> na se√ß√£o implementation de <code>Modulo.Parameters.pas</code></li>
                <li>Atualizar factory methods em <code>Modulo.Parameters.pas</code></li>
                <li>Validar encapsulamento (verificar que implementa√ß√µes n√£o s√£o acess√≠veis)</li>
                <li>Testes e valida√ß√£o</li>
            </ol>
        </div>
    </div>
</body>
</html>

